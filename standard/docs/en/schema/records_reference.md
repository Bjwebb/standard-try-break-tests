# Record Reference

Whereas there can be multiple releases concerning a given contracting process, there should be a single **contracting record** for each OCID, providing a summary of all the available data about this particular contracting process.

A record **must** contain:

* An [OCID](../../key_concepts/identifiers#ocid)
* An array of **[releases](#release)** related to this contracting process - either by providing a URL for where these releases can be found, or embedding a full copy of the release

This allows the record to function as an index of all the releases related to a given contracting process.

Records **should** contain:

* **compiledRelease** - the latest version of all open contracting process fields, represented using the release schema. 

Records **may** optionally contain:

* **versionedRelease** - containing the history of the data in the compiledRecord, with all known past values of any field and the release that information came from. 

The versioned release format is designed to support analysis of how data has changed between releases, and will often be generated by data users, rather than by publishers.

## Package meta-data

Records should be embedded within a record package.  

```eval_rst
.. csv-table::
   :header-rows: 1
   :file: standard/docs/field_definitions/record-package.csv
```

See the guidance on [package meta-data](reference.md#package-metadata). In addition, a record package includes:

* ```packages``` - which should provide links to all the release packages used to compile this record. 
* ```records``` - one or more contracting process records, containing, at the very least, identifiers for the all the releases that relate to each contracting process.

You can see this in the full example of a record below.

```eval_rst

.. jsoninclude:: docs/en/examples/versioned.json
   :jsonpointer: 
   :expand: packages, records
   :title: Full_record

```

## Record structure

Each record package contains an array of one or more records, consisting of the following sections:

* Releases (required)
* Compiled Release (optional)
* Versioning Release (optional)

### Release list

The releases that go to make up a contracting process can be provided in two ways:

* URLs and meta-data for each release; or
* Embedded copies of the release;

If providing and array of URLs, it should be possible for a consuming application to look up each URL, retrieve a release package, and locate the release inside it. In order to locate the specific release inside a release package the releaseID of the release should be appended to the package URL using a fragment identifier.

An example releases section is given below. 

```eval_rst

.. jsoninclude:: docs/en/examples/versioned.json
   :jsonpointer: /records/0
   :expand: releases, tag
   :title: releases

```

### Compiled Release

The compiled release is latest version of all the data about this contracting process, and has the same schema as a release.

The process for creating a compiled release is described in the guidance on [merging](../implementation/merging.md). 

A compiled release provides a snapshot of the current state of a contracting process, and the contents should follow the release schema.

### Versioned Release

A versioned release contains the history of all the data in the compiled release, including which fields have changed, when they were changed, and the release that updated them.

This versioned information is valuable for many use cases relating to contract monitoring. However, it can add substantially to file sizes, and so where publishers do generate this at source, they should consider publishing versioned and non-versioned copies of the records.

Third parties should also be able to use the information in the releases list to fetch source data, compile and verify their own version history for a contract.

An example extract of the versioned information for a tender value is shown below. This makes visible the change in contract value from the planning to the tender stage, whilst currency, which was first encountered in the planning stage stayed unchanged. 

```eval_rst

.. jsoninclude:: docs/en/examples/versioned.json
   :jsonpointer: /records/0/versionedRelease/tender/value
   :expand: amount, releaseTag
   :title: versioned

```




<style>
    pre.renderjson { overflow: scroll; font-size:smaller; border: 1px solid grey;}
    .renderjson a { text-decoration: none; }
    .renderjson .disclosure { color: crimson; font-size: 150%; }
    .renderjson .syntax { color: grey; }
    .renderjson .string { color: darkred; }
    .renderjson .number { color: darkcyan; }
    .renderjson .boolean { color: blueviolet; }
    .renderjson .key    { color: darkblue; }
    .renderjson .keyword { color: blue; }
    .renderjson .object.syntax { color: lightseagreen; }
    .renderjson .array.syntax  { color: orange; }
  </style>
  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" defer><!--
  var module;(module||{}).exports=renderjson=function(){function n(i,c,f,y,_,d){var p=f?"":c,g=function(n,o,i,c,f){var _,d=a(c),g=function(){_||e(d.parentNode,_=r(f(),u(l.hide,"disclosure",function(){_.style.display="none",d.style.display="inline"}))),_.style.display="inline",d.style.display="none"};e(d,u(l.show,"disclosure",g),t(c+" syntax",n),u(o,null,g),t(c+" syntax",i));var h=e(a(),s(p.slice(0,-1)),d);return y>0&&g(),h};return null===i?t(null,p,"keyword","null"):void 0===i?t(null,p,"keyword","undefined"):"string"==typeof i&&i.length>_?g('"',i.substr(0,_)+" ...",'"',"string",function(){return e(a("string"),t(null,p,"string",JSON.stringify(i)))}):"object"!=typeof i?t(null,p,typeof i,JSON.stringify(i)):i.constructor==Array?0==i.length?t(null,p,"array syntax","[]"):g("["," ... ","]","array",function(){for(var r=e(a("array"),t("array syntax","[",null,"\n")),o=0;o<i.length;o++)e(r,n(i[o],c+"    ",!1,y-1,_,d),o!=i.length-1?t("syntax",","):[],s("\n"));return e(r,t(null,c,"array syntax","]")),r}):o(i)?t(null,p,"object syntax","{}"):g("{","...","}","object",function(){var r=e(a("object"),t("object syntax","{",null,"\n"));for(var o in i)var u=o;var f=Object.keys(i);d&&(f=f.sort());for(var p in f){var o=f[p];e(r,t(null,c+"    ","key",'"'+o+'"',"object syntax",": "),n(i[o],c+"    ",!0,l.default_open.indexOf(o)>-1?y+1:y-1,_,d),o!=u?t("syntax",","):[],s("\n"))}return e(r,t(null,c,"object syntax","}")),r})}var t=function(){for(var n=[];arguments.length;)n.push(e(a(Array.prototype.shift.call(arguments)),s(Array.prototype.shift.call(arguments))));return n},e=function(){for(var n=Array.prototype.shift.call(arguments),t=0;t<arguments.length;t++)arguments[t].constructor==Array?e.apply(this,[n].concat(arguments[t])):n.appendChild(arguments[t]);return n},r=function(n,t){return n.insertBefore(t,n.firstChild),n},o=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},s=function(n){return document.createTextNode(n)},a=function(n){var t=document.createElement("span");return n&&(t.className=n),t},u=function(n,t,e){var r=document.createElement("a");return t&&(r.className=t),r.appendChild(s(n)),r.href="#",r.onclick=function(){return e(),!1},r},l=function i(t){var r=e(document.createElement("pre"),n(t,"",!1,i.show_to_level,i.max_string_length,i.sort_objects));return r.className="renderjson",r};return l.set_icons=function(n,t){return l.show=n,l.hide=t,l},l.set_show_to_level=function(n){return l.show_to_level="string"==typeof n&&"all"===n.toLowerCase()?Number.MAX_VALUE:n,l},l.set_max_string_length=function(n){return l.max_string_length="string"==typeof n&&"none"===n.toLowerCase()?Number.MAX_VALUE:n,l},l.set_sort_objects=function(n){return l.sort_objects=n,l},l.set_show_by_default=function(n){return l.show_to_level=n?Number.MAX_VALUE:0,l},l.set_default_open=function(n){return l.default_open=n?n:[],l},l.set_icons("⊕","⊖"),l.set_show_by_default(!1),l.set_sort_objects(!1),l.set_max_string_length("none"),l.set_default_open([]),l}();
  $( document ).ready(function() {
      $(".expandjson").each(function(){
       classList = $(this).attr("class").split(/\s+/);
       expand = []
       $.each(classList, function(index, item) {
         if (item.indexOf('expand') === 0) {
           expand.push(item.replace('expand-',''))
         }
         if (item.indexOf('file') === 0) {
           filename = item
         }
       });
       jsontext = $(this).text().trim()
       json = JSON.parse(jsontext)
       if(json.length) {
           json = json[0]
       }
       $(this).html(renderjson.set_show_to_level(1).set_max_string_length(100).set_default_open(expand)(json))
       if($(this).siblings(".selection-container").length === 0) { // NEED TO FIX THE CODE HERE. MOVE THINGS INTO THE PARENT CLASS CORRECTLY!
           id = Math.floor(5 * (Math.random() % 1));
           $(this).wrap("<div class='selection-container'></div>")
           $(this).parent().prepend(
               $("<select name='select-"+id +"'></select>")
               .change(function(){ 
                    $(this).siblings(".highlight-json").hide();
                    $(this).siblings("."+ $(this).val()).show();
                }))
           $(this).siblings("select").append($("<option></option>").attr("value",filename).text(filename.replace("file-",""))) 
       } else {   
           container = $(this).siblings(".selection-container")
           $(this).detach().appendTo(container)
           $(this).siblings("select").append($("<option></option>").attr("value",filename).text(filename.replace("file-",""))) 
           $(this).hide()
       }
    });
});
--></script>